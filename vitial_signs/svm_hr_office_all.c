#include <stdlib.h>
#include <stdio.h> 
#include <math.h>
#include "svm_hr_office_all.h"

int predict_hr (double features_hr[]) {
    double vectors_hr[173][3] = {{1.2531328320802004, 62.66239466292135, 65.53172279386484}, {1.2280701754385965, 75.07753979400749, 74.14261589097917}, {1.0275689223057645, 76.31671348314607, 64.01578829380755}, {1.2030075187969924, 71.85598080524345, 71.43276791804739}, {1.2531328320802004, 68.72659176029963, 62.78107529543759}, {1.2280701754385965, 71.48730102996255, 64.21883160880442}, {1.1528822055137844, 70.78797986891385, 70.39240062966032}, {1.3032581453634084, 90.8349609375, 73.5514892578125}, {1.2030075187969924, 71.97155898876404, 74.22890480984462}, {1.3032581453634084, 82.23168305243446, 83.6097741859236}, {1.5288220551378446, 89.00983146067416, 88.53768067473031}, {1.3533834586466165, 84.21845739700375, 83.5741044805291}, {1.3533834586466165, 82.32385299625469, 80.0}, {1.2531328320802004, 63.0500936329588, 67.44567832994402}, {1.1278195488721805, 73.70084269662921, 71.88808012544439}, {1.0776942355889725, 69.82677902621722, 65.48829157492344}, {1.1528822055137844, 70.45294943820225, 71.76262435246348}, {1.1779448621553885, 72.60065543071161, 68.59562993615158}, {1.1779448621553885, 83.02902621722846, 66.47685590308257}, {0.9523809523809523, 81.7646484375, 71.73836683273315}, {1.0526315789473684, 72.8994140625, 66.53947870254517}, {1.6290726817042607, 88.3564453125, 50.0}, {1.6290726817042607, 97.0125234082397, 81.37555316444045}, {1.5538847117794485, 88.0458984375, 78.10982603549957}, {1.5538847117794485, 93.92848782771536, 93.86344086722042}, {1.6290726817042607, 92.43474953183521, 96.23055847396564}, {1.3784461152882206, 96.17421582397004, 66.12658125630925}, {1.4285714285714286, 84.35159176029963, 60.76248464691505}, {1.1027568922305764, 98.41409176029963, 69.54695940910653}, {1.2781954887218046, 88.43408203125, 74.68342675209045}, {1.1779448621553885, 90.69580078125, 55.46809587478638}, {1.1528822055137844, 81.68305243445693, 89.76070373573256}, {1.5538847117794485, 64.33900983146067, 54.55084017540483}, {1.4035087719298245, 87.07470703125, 8.5e+30}, {1.0025062656641603, 79.74010286783043, 83.8360832575848}, {1.3283208020050126, 74.9122191011236, 67.4040184497238}, {1.4615384615384615, 73.38754795396419, 8.746318514366967e+25}, {1.0309278350515463, 65.5269666988417, 64.3990652018072}, {1.1528822055137844, 67.39963717228464, 68.77677575538816}, {1.1528822055137844, 69.23583984375, 69.26715831756592}, {1.3032581453634084, 57.20973782771536, 50.0}, {0.9523809523809523, 70.92550327715355, 55.707151948735955}, {1.4285714285714286, 52.41982677902622, 63.83249366179239}, {1.6290726817042607, 60.978515625, 63.363509964942935}, {1.1027568922305764, 66.89501953125, 66.0776859664917}, {0.9774436090225563, 58.51318359375, 59.71590560913086}, {0.9523809523809523, 67.29868913857678, 68.57903385043294}, {0.9523809523809523, 66.9052734375, 60.31010117053986}, {1.2030075187969924, 69.09527153558052, 72.75539669651218}, {1.4786967418546366, 84.04143258426966, 63.792330481139906}, {1.3533834586466165, 91.93293539325843, 70.84315270698919}, {1.3032581453634084, 93.37839419475655, 79.46382859286}, {1.2531328320802004, 81.53821395131087, 86.85352181614412}, {1.2531328320802004, 83.82198033707866, 72.01900915557823}, {1.2781954887218046, 82.43504213483146, 85.05247601379318}, {1.2781954887218046, 84.123046875, 79.0455881881714}, {1.1027568922305764, 77.6963366104869, 68.29208829310652}, {1.2280701754385965, 100.31308520599251, 62.77511188064175}, {1.4035087719298245, 94.98039559925094, 76.12044871850556}, {1.4285714285714286, 89.6286867977528, 84.53718652618065}, {1.0275689223057645, 61.904552902621724, 66.17785956945907}, {1.4536340852130325, 92.70394428838951, 63.71054088578242}, {1.0526315789473684, 72.94300093632958, 58.754139475161665}, {0.9523809523809523, 67.4501953125, 60.20743498802185}, {1.0526315789473684, 73.06735720973782, 70.53306086203281}, {1.2781954887218046, 73.85738529962546, 67.95733257774705}, {1.2030075187969924, 72.5478515625, 70.55771842956543}, {1.2280701754385965, 69.27083333333333, 71.52695919898864}, {1.2030075187969924, 71.06010065543072, 68.13619365525454}, {1.1278195488721805, 69.6307350187266, 61.955767037419044}, {1.2030075187969924, 74.54500234082397, 85.71501246343986}, {1.0776942355889725, 60.14501953125, 62.169168157577516}, {1.1278195488721805, 78.43808520599251, 59.71170257301664}, {1.3533834586466165, 77.52370084269663, 73.79806863353791}, {1.2030075187969924, 73.31899578651685, 73.7211962543921}, {1.5037593984962405, 90.27387640449439, 92.30769348144533}, {1.3283208020050126, 86.19140625, 68.92162628173828}, {1.2781954887218046, 80.24198267790263, 68.14059978775614}, {1.2781954887218046, 71.08058286516854, 69.10112432415566}, {1.0526315789473684, 68.41643258426966, 71.76006531447507}, {1.3032581453634084, 81.20464653558052, 74.717877467771}, {1.5789473684210527, 57.82955078601837, 66.5714298915863}, {1.3283208020050126, 67.80781835205993, 68.25837534167496}, {1.2531328320802004, 75.42134831460675, 68.51561661814334}, {1.3283208020050126, 79.5322265625, 61.97024059295654}, {1.4786967418546366, 68.64027387640449, 58.06010248419944}, {1.6791979949874687, 90.3338600187266, 60.709687693735184}, {1.6290726817042607, 88.32806647940075, 66.79562744635916}, {1.4285714285714286, 73.4097027153558, 71.89070891857743}, {1.6040100250626566, 95.6337890625, 89.74519309997558}, {1.1528822055137844, 98.67011938202248, 86.01191869538077}, {1.5789473684210527, 92.21968632958801, 92.09237545170588}, {1.6290726817042607, 67.84716796875, 54.54545211791992}, {1.4285714285714286, 71.96570692883896, 53.67623575617758}, {1.0025062656641603, 96.27077481273409, 50.62168215633778}, {1.5288220551378446, 89.19140625, 75.34681219100953}, {1.4536340852130325, 85.78095739700375, 86.74841927708162}, {1.4035087719298245, 71.17860486891385, 66.81844257445222}, {1.3032581453634084, 73.56185627340824, 62.448257960630265}, {1.2280701754385965, 77.19305945692884, 81.76386725798379}, {1.2280701754385965, 74.13535814606742, 75.5434382482712}, {1.3784461152882206, 85.87897940074906, 80.76868235841673}, {1.3283208020050126, 76.23624765917603, 79.12609238451935}, {1.2030075187969924, 74.01685393258427, 77.4101699276661}, {1.2531328320802004, 76.39279026217228, 76.23595505617978}, {1.5789473684210527, 84.66943359375, 74.39820806503296}, {1.4786967418546366, 94.17134831460675, 86.3728043250228}, {1.6040100250626566, 85.25719803370787, 82.16431654645561}, {1.6290726817042607, 94.34105805243446, 61.317236996768564}, {1.6290726817042607, 98.54296875, 89.88085303783417}, {1.5538847117794485, 95.94305945692884, 70.84201730830543}, {1.2781954887218046, 66.94171348314607, 66.44701756966694}, {1.0776942355889725, 61.78751170411985, 61.889615681585155}, {1.0275689223057645, 60.50883661048689, 60.02252871624093}, {1.1027568922305764, 66.4833984375, 64.56140747070313}, {1.0275689223057645, 71.0220622659176, 72.74939891610401}, {1.1278195488721805, 72.13687968164794, 69.3104215471932}, {1.1027568922305764, 66.66081460674157, 67.93417606044203}, {1.1528822055137844, 72.20947265625, 69.24922618865966}, {1.1027568922305764, 69.18158941947566, 70.48020765992734}, {1.1278195488721805, 69.96430243445693, 72.19162331151307}, {1.1027568922305764, 71.10399110486891, 72.4608936952741}, {1.1528822055137844, 69.67316245318352, 71.02885977069984}, {1.1528822055137844, 70.68410580524345, 67.44356150156847}, {1.4786967418546366, 82.09415964419476, 61.21568807918629}, {1.3533834586466165, 90.93808520599251, 60.61887556307027}, {1.0526315789473684, 67.57080992509363, 57.38443068886517}, {0.9774436090225563, 73.59989466292134, 61.850320994630735}, {1.3032581453634084, 75.25602762172285, 76.93493981903114}, {1.4035087719298245, 91.52475421348315, 53.81005404564028}, {0.9774436090225563, 109.18480805243446, 59.93818527393127}, {1.2781954887218046, 73.18000936329588, 71.11707788817445}, {1.1528822055137844, 72.12451171875, 71.58433453083039}, {1.4357682619647356, 68.58560380025126, 66.69451037843024}, {1.1278195488721805, 75.390625, 67.49342035681717}, {0.9774436090225563, 71.73893960674157, 56.50568472758661}, {1.0275689223057645, 61.71875, 66.3556568464834}, {1.0526315789473684, 63.99812734082397, 65.25795624884178}, {1.1528822055137844, 67.75514981273409, 68.9164345178116}, {1.3032581453634084, 67.33672752808988, 62.050071078144505}, {1.0776942355889725, 66.79102294007491, 62.634567365515394}, {1.1278195488721805, 74.2070458801498, 68.49113599608155}, {1.4536340852130325, 92.47132490636704, 65.6600536294049}, {1.0275689223057645, 77.01708984375, 63.126162939071655}, {1.0776942355889725, 65.11001872659176, 66.05340216133033}, {1.1278195488721805, 74.79225187265918, 67.77168568243248}, {1.1278195488721805, 67.88389513108615, 68.63969243272264}, {1.4536340852130325, 73.01029962546816, 63.88106907381398}, {1.0526315789473684, 75.31601123595506, 65.80246061213157}, {1.1528822055137844, 74.5376872659176, 74.1147108613775}, {0.9523809523809523, 61.10428370786517, 62.01196129045236}, {1.1528822055137844, 66.12681413857678, 68.41229282336289}, {1.4786967418546366, 72.169921875, 64.4342144203186}, {0.9273182957393483, 62.18545177902622, 64.77617532870593}, {0.9273182957393483, 76.67954119850187, 62.132455909147986}, {0.9523809523809523, 68.033203125, 56.948053169250485}, {0.9022556390977443, 69.56782537453184, 56.389456488219984}, {0.9375, 57.18871911573472, 59.21308017284787}, {0.9523809523809523, 59.729049625468164, 57.631534724050994}, {0.9273182957393483, 79.58362593632958, 64.47352100043707}, {0.9523809523809523, 67.9468047752809, 60.04092862513777}, {0.9319899244332494, 58.13883872487437, 59.08284016709831}, {0.9898477157360406, 63.28570015822785, 60.003794918784614}, {0.9523809523809523, 57.27411048689139, 57.32899055528581}, {1.1278195488721805, 74.60595703125, 80.12857219696045}, {1.1528822055137844, 68.04190074906367, 61.81798609663336}, {1.4285714285714286, 70.36669921875, 70.5882339477539}, {1.1278195488721805, 69.5970856741573, 69.40833820624}, {1.1528822055137844, 74.22752808988764, 74.68238317177686}, {1.1278195488721805, 71.5063202247191, 70.99581283397889}, {1.1027568922305764, 68.85387406367042, 69.42975750755282}, {1.2030075187969924, 71.69651217228464, 71.38075075375751}, {1.2280701754385965, 81.43580290262172, 73.05154414182894}};
    double coefficients_hr[1][173] = {{-1.0, -0.471231103999489, -1.0, -1.0, -1.0, -0.7804308273051407, -1.0, -0.04961539837721799, -1.0, -0.05663449689535068, -0.1347807566594151, -0.021901859332395912, -0.08991794067990042, -1.0, -0.5820708311601996, -1.0, -1.0, -1.0, -0.26079950850553757, -0.710156069029154, -1.0, -0.30218758148202157, -0.18891408887625594, -0.139164157101698, -0.11335109907064882, -0.16958157459145254, -0.28471630688889366, -0.643786999556924, -0.14149359448773272, -0.07800735934121147, -0.9491936354968611, -0.19755236549650312, -0.2900026543271842, -0.24459224954118985, -0.05890844287645507, -1.0, -0.24433476051537062, -1.0, -1.0, -1.0, -0.24897645415254832, -1.0, -0.2506987824576144, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.2389053814740942, -0.22658385400935593, -0.14993866323770663, -0.07023376451846261, -0.043856654867283996, -0.03156966808143824, -0.040527859760392235, -0.5784122615259419, -0.22472228807290337, -0.17897429132473974, -0.169483343234887, -1.0, -0.898321532368979, -0.8130893473887892, -1.0, -1.0, -0.6447477165377659, -1.0, -1.0, -1.0, -0.8128269120489636, -0.2514131933678309, -1.0, -0.5560164526485609, -0.06246626092594197, -1.0, -0.1632847966995854, -0.019979169369838082, -0.037708825971470426, -1.0, -1.0, -0.5980396742514761, -0.1019554501985678, -1.0, -0.9337595822943044, -1.0, -1.0, -0.9615438101562999, -0.2910873698262744, -1.0, -0.095335756554589, -0.1631081446611446, -0.003908409058340106, -1.0, -0.19841989448327363, -0.27768496130326764, -0.04545862611625305, -0.12814317104526826, -0.08155355034300618, -1.0, -0.24897339903734653, -0.13339487427828312, -0.06541878752843779, -0.6936947430446386, -1.0, -0.6398047103137574, -0.14279837965032124, -0.1612787862644476, -0.06815458513381624, -0.04364647201404075, -0.15797866326464893, -0.1114903121879186, 0.6869010564054671, 1.0, 0.675412504977476, 0.8653220131685545, 1.0, 1.0, 0.6930681222597206, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6617798416528801, 1.0, 1.0, 0.5161455391060382, 0.6959782690928686, 0.7136613777261162, 1.0, 1.0, 0.9755793652093658, 1.0, 1.0, 1.0, 0.7788471590505324, 1.0, 1.0}};
    double intercepts_hr[1] = {0.7554219947266392};
    int weights_hr[2] = {111, 62};

    int i_hr, j_hr, k_hr, d_hr, l_hr;

    double kernels_hr[N_VECTORS_HR];
    double kernel_hr;
    switch (KERNEL_TYPE_HR) {
        case 'l':
            // <x,x'>
            for (i_hr = 0; i_hr < N_VECTORS_HR; i_hr++) {
                kernel_hr = 0.;
                for (j_hr = 0; j_hr < N_FEATURES_HR; j_hr++) {
                    kernel_hr += vectors_hr[i_hr][j_hr] * features_hr[j_hr];
                }
                kernels_hr[i_hr] = kernel_hr;
            }
            break;
        case 'p':
            // (y<x,x'>+r)^d_hr
            for (i_hr = 0; i_hr < N_VECTORS_HR; i_hr++) {
                kernel_hr = 0.;
                for (j_hr = 0; j_hr < N_FEATURES_HR; j_hr++) {
                    kernel_hr += vectors_hr[i_hr][j_hr] * features_hr[j_hr];
                }
                kernels_hr[i_hr] = pow((KERNEL_GAMMA_HR * kernel_hr) + KERNEL_COEF_HR, KERNEL_DEGREE_HR);
            }
            break;
        case 'r':
            // exp(-y|x-x'|^2)
            for (i_hr = 0; i_hr < N_VECTORS_HR; i_hr++) {
                kernel_hr = 0.;
                for (j_hr = 0; j_hr < N_FEATURES_HR; j_hr++) {
                    kernel_hr += pow(vectors_hr[i_hr][j_hr] - features_hr[j_hr], 2);
                }
                kernels_hr[i_hr] = exp(-KERNEL_GAMMA_HR * kernel_hr);
            }
            break;
        case 's':
            // tanh(y<x,x'>+r)
            for (i_hr = 0; i_hr < N_VECTORS_HR; i_hr++) {
                kernel_hr = 0.;
                for (j_hr = 0; j_hr < N_FEATURES_HR; j_hr++) {
                    kernel_hr += vectors_hr[i_hr][j_hr] * features_hr[j_hr];
                }
                kernels_hr[i_hr] = tanh((KERNEL_GAMMA_HR * kernel_hr) + KERNEL_COEF_HR);
            }
            break;
    }

    int starts_hr[N_ROWS_HR];
    int start_hr;
    for (i_hr = 0; i_hr < N_ROWS_HR; i_hr++) {
        if (i_hr != 0) {
            start_hr = 0;
            for (j_hr = 0; j_hr < i_hr; j_hr++) {
                start_hr += weights_hr[j_hr];
            }
            starts_hr[i_hr] = start_hr;
        } else {
            starts_hr[0] = 0;
        }
    }

    int ends_hr[N_ROWS_HR];
    for (i_hr = 0; i_hr < N_ROWS_HR; i_hr++) {
        ends_hr[i_hr] = weights_hr[i_hr] + starts_hr[i_hr];
    }

    if (N_CLASSES_HR == 2) {

        for (i_hr = 0; i_hr < N_VECTORS_HR; i_hr++) {
            kernels_hr[i_hr] = -kernels_hr[i_hr];
        }

        double decision_hr = 0.;
        for (k_hr = starts_hr[1]; k_hr < ends_hr[1]; k_hr++) {
            decision_hr += kernels_hr[k_hr] * coefficients_hr[0][k_hr];
        }
        for (k_hr = starts_hr[0]; k_hr < ends_hr[0]; k_hr++) {
            decision_hr += kernels_hr[k_hr] * coefficients_hr[0][k_hr];
        }
        decision_hr += intercepts_hr[0];

        if (decision_hr > 0) {
            return 0;
        }
        return 1;

    }

    double decisions_hr[N_INTERCEPTS_HR];
    double tmp_hr;
    for (i_hr = 0, d_hr = 0, l_hr = N_ROWS_HR; i_hr < l_hr; i_hr++) {
        for (j_hr = i_hr + 1; j_hr < l_hr; j_hr++) {
            tmp_hr = 0.;
            for (k_hr = starts_hr[j_hr]; k_hr < ends_hr[j_hr]; k_hr++) {
                tmp_hr += kernels_hr[k_hr] * coefficients_hr[i_hr][k_hr];
            }
            for (k_hr = starts_hr[i_hr]; k_hr < ends_hr[i_hr]; k_hr++) {
                tmp_hr += kernels_hr[k_hr] * coefficients_hr[j_hr - 1][k_hr];
            }
            decisions_hr[d_hr] = tmp_hr + intercepts_hr[d_hr];
            d_hr = d_hr + 1;
        }
    }

    int votes_hr[N_INTERCEPTS_HR];
    for (i_hr = 0, d_hr = 0, l_hr = N_ROWS_HR; i_hr < l_hr; i_hr++) {
        for (j_hr = i_hr + 1; j_hr < l_hr; j_hr++) {
            votes_hr[d_hr] = decisions_hr[d_hr] > 0 ? i_hr : j_hr;
            d_hr = d_hr + 1;
        }
    }

    int amounts_hr[N_CLASSES_HR];
    for (i_hr = 0, l_hr = N_CLASSES_HR; i_hr < l_hr; i_hr++) {
        amounts_hr[i_hr] = 0;
    }
    for (i_hr = 0; i_hr < N_INTERCEPTS_HR; i_hr++) {
        amounts_hr[votes_hr[i_hr]] += 1;
    }

    int classVal_hr = -1;
    int classIdx_hr = -1;
    for (i_hr = 0; i_hr < N_CLASSES_HR; i_hr++) {
        if (amounts_hr[i_hr] > classVal_hr) {
            classVal_hr = amounts_hr[i_hr];
            classIdx_hr= i_hr;
        }
    }
    return classIdx_hr;

}